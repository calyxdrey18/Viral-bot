<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WhatsApp Pairing Code Generator</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        * {
            font-family: 'Inter', sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #075E54 0%, #128C7E 30%, #25D366 100%);
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
            position: relative;
            overflow-x: hidden;
        }
        
        body::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: 
                radial-gradient(circle at 20% 80%, rgba(255,255,255,0.1) 0%, transparent 50%),
                radial-gradient(circle at 80% 20%, rgba(255,255,255,0.1) 0%, transparent 50%);
            pointer-events: none;
        }
        
        .glass {
            background: rgba(255, 255, 255, 0.98);
            backdrop-filter: blur(20px);
            border-radius: 28px;
            box-shadow: 
                0 25px 50px -12px rgba(0, 0, 0, 0.25),
                inset 0 1px 0 0 rgba(255, 255, 255, 0.2);
            border: 1px solid rgba(255, 255, 255, 0.3);
        }
        
        .code-box {
            letter-spacing: 6px;
            background: linear-gradient(135deg, #f0fdf4 0%, #dcfce7 100%);
            border: 2px solid #86efac;
            position: relative;
            overflow: hidden;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            cursor: pointer;
        }
        
        .code-box::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.4), transparent);
            transition: left 0.5s ease;
        }
        
        .code-box:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px -5px rgba(34, 197, 94, 0.3);
            border-color: #4ade80;
        }
        
        .code-box:hover::before {
            left: 100%;
        }
        
        .code-box:active {
            transform: scale(0.98);
        }
        
        @keyframes popIn {
            0% {
                opacity: 0;
                transform: scale(0.9) translateY(10px);
            }
            100% {
                opacity: 1;
                transform: scale(1) translateY(0);
            }
        }
        
        .animate-pop {
            animation: popIn 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #25D366 0%, #128C7E 100%);
            box-shadow: 0 4px 15px rgba(37, 211, 102, 0.3);
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        
        .btn-primary::after {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transition: left 0.5s ease;
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(37, 211, 102, 0.4);
        }
        
        .btn-primary:hover::after {
            left: 100%;
        }
        
        .btn-primary:active {
            transform: translateY(0);
        }
        
        .input-field {
            background: #f8fafc;
            border: 2px solid #e2e8f0;
            transition: all 0.3s ease;
        }
        
        .input-field:focus {
            background: white;
            border-color: #86efac;
            box-shadow: 0 0 0 3px rgba(34, 197, 94, 0.1);
        }
        
        .step-box {
            background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%);
            border: 1px solid #bae6fd;
        }
        
        .logo-circle {
            width: 80px;
            height: 80px;
            background: linear-gradient(135deg, #25D366 0%, #128C7E 100%);
            margin: 0 auto 20px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 10px 25px rgba(37, 211, 102, 0.3);
        }
        
        .pulse {
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0% {
                box-shadow: 0 0 0 0 rgba(37, 211, 102, 0.4);
            }
            70% {
                box-shadow: 0 0 0 15px rgba(37, 211, 102, 0);
            }
            100% {
                box-shadow: 0 0 0 0 rgba(37, 211, 102, 0);
            }
        }
        
        .success-message {
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        
        .success-message.show {
            opacity: 1;
        }
    </style>
</head>
<body>
    <div class="glass p-10 w-full max-w-lg mx-4">
        <!-- Logo -->
        <div class="logo-circle pulse">
            <i class="fab fa-whatsapp text-white text-4xl"></i>
        </div>
        
        <!-- Header -->
        <div class="text-center mb-8">
            <h1 class="text-3xl font-bold text-gray-800 mb-2">
                WhatsApp Pairing Code
            </h1>
            <p class="text-gray-500">
                Generate a secure code to link your WhatsApp account
            </p>
        </div>

        <!-- Input Section -->
        <div class="space-y-6 mb-8">
            <div>
                <label class="block text-sm font-medium text-gray-700 mb-2 text-left">
                    <i class="fas fa-phone mr-2 text-green-500"></i>
                    Phone Number
                </label>
                <input 
                    id="phone" 
                    type="text" 
                    placeholder="e.g. 2348100000000 (with country code)" 
                    class="input-field w-full p-4 rounded-xl focus:ring-0 focus:outline-none text-gray-700 placeholder-gray-400"
                >
                <p class="text-xs text-gray-400 mt-2 text-left">
                    Include country code without the '+' sign
                </p>
            </div>
            
            <button 
                onclick="getPair()" 
                id="mainBtn" 
                class="btn-primary w-full text-white font-bold py-4 rounded-xl transition-all"
            >
                <span class="flex items-center justify-center">
                    <i class="fas fa-qrcode mr-3"></i>
                    GENERATE PAIRING CODE
                </span>
            </button>
        </div>

        <!-- Result Section -->
        <div id="resultArea" class="hidden space-y-8 animate-pop">
            <!-- Success Message -->
            <div class="bg-green-50 border border-green-100 rounded-2xl p-6 text-center">
                <i class="fas fa-check-circle text-green-500 text-4xl mb-3"></i>
                <h3 class="text-lg font-semibold text-green-700 mb-1">
                    Code Generated Successfully!
                </h3>
                <p class="text-sm text-green-600">
                    Your pairing code is ready to use
                </p>
            </div>

            <!-- Code Display -->
            <div>
                <p class="text-xs font-semibold text-gray-400 uppercase tracking-wider mb-3">
                    <i class="far fa-copy mr-2"></i>
                    Tap to copy code
                </p>
                <div 
                    id="codeDisplay" 
                    class="code-box text-4xl font-black text-green-600 p-8 rounded-2xl text-center"
                    onclick="copyCode()"
                ></div>
                
                <!-- Copy Status -->
                <div id="copyStatus" class="success-message mt-3">
                    <p class="text-sm font-semibold text-green-500 flex items-center justify-center">
                        <i class="fas fa-check mr-2"></i>
                        Code copied to clipboard!
                    </p>
                </div>
            </div>

            <!-- Instructions -->
            <div class="step-box p-6 rounded-2xl">
                <h4 class="text-lg font-semibold text-blue-800 mb-4 flex items-center">
                    <i class="fas fa-info-circle mr-2"></i>
                    How to use this code:
                </h4>
                <div class="space-y-4">
                    <div class="flex items-start space-x-3">
                        <div class="flex-shrink-0 w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center">
                            <span class="text-blue-600 font-bold text-sm">1</span>
                        </div>
                        <p class="text-sm text-blue-700">
                            Open WhatsApp on your phone and go to <span class="font-semibold">Settings</span> → <span class="font-semibold">Linked Devices</span>
                        </p>
                    </div>
                    <div class="flex items-start space-x-3">
                        <div class="flex-shrink-0 w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center">
                            <span class="text-blue-600 font-bold text-sm">2</span>
                        </div>
                        <p class="text-sm text-blue-700">
                            Tap <span class="font-semibold">"Link a Device"</span> → <span class="font-semibold">"Link with phone number instead"</span>
                        </p>
                    </div>
                    <div class="flex items-start space-x-3">
                        <div class="flex-shrink-0 w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center">
                            <span class="text-blue-600 font-bold text-sm">3</span>
                        </div>
                        <p class="text-sm text-blue-700">
                            Enter the 6-digit code shown above when prompted
                        </p>
                    </div>
                </div>
            </div>

            <!-- Security Note -->
            <div class="bg-amber-50 border border-amber-100 rounded-2xl p-4">
                <p class="text-xs text-amber-700 flex items-start">
                    <i class="fas fa-shield-alt mr-2 mt-0.5"></i>
                    <span>
                        <span class="font-semibold">Security Note:</span> This code is valid for a limited time. Never share it with anyone.
                    </span>
                </p>
            </div>
        </div>

        <!-- Footer -->
        <div class="mt-10 pt-6 border-t border-gray-100">
            <p class="text-xs text-gray-400 text-center">
                <i class="fas fa-lock mr-1"></i>
                Secure connection • Generated codes are encrypted
            </p>
        </div>
    </div>

    <script>
        async function getPair() {
            const phone = document.getElementById('phone').value;
            const btn = document.getElementById('mainBtn');
            const result = document.getElementById('resultArea');
            const codeBox = document.getElementById('codeDisplay');

            if (!phone) {
                alert("Please enter your phone number with country code!");
                return;
            }

            // Validate phone number format (basic validation)
            if (!/^\d{10,15}$/.test(phone)) {
                alert("Please enter a valid phone number (10-15 digits, including country code)");
                return;
            }

            // Update button state
            btn.disabled = true;
            btn.innerHTML = '<i class="fas fa-circle-notch fa-spin mr-2"></i> GENERATING SECURE CODE...';
            result.classList.add('hidden');

            try {
                // Simulate API call - replace with your actual endpoint
                const res = await fetch('/pair', {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({ phone })
                });
                
                const data = await res.json();

                if (data.code && data.code !== "FAILED") {
                    // Display the code with formatting
                    codeBox.innerText = data.code.match(/.{1,3}/g).join(' ');
                    result.classList.remove('hidden');
                    
                    // Scroll to result
                    result.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
                } else {
                    alert("Error generating code. Please ensure:\n• Number includes country code\n• Number is valid\n• Try again in a moment");
                }
            } catch (e) {
                console.error("Error:", e);
                alert("Connection error. Please check your internet connection and try again.");
            } finally {
                btn.disabled = false;
                btn.innerHTML = '<i class="fas fa-sync mr-2"></i> GENERATE NEW CODE';
            }
        }

        function copyCode() {
            const codeElement = document.getElementById('codeDisplay');
            const code = codeElement.innerText.replace(/\s/g, ''); // Remove spaces
            navigator.clipboard.writeText(code);
            
            const status = document.getElementById('copyStatus');
            status.classList.add('show');
            
            // Visual feedback
            codeElement.style.background = 'linear-gradient(135deg, #dcfce7 0%, #bbf7d0 100%)';
            codeElement.style.borderColor = '#4ade80';
            
            setTimeout(() => {
                status.classList.remove('show');
                codeElement.style.background = 'linear-gradient(135deg, #f0fdf4 0%, #dcfce7 100%)';
                codeElement.style.borderColor = '#86efac';
            }, 2000);
        }

        // Add enter key support
        document.getElementById('phone').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                getPair();
            }
        });
    </script>
</body>
</html>